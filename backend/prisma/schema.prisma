generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}

enum Role {
  USER
  BARBER
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  CANCELLED
  DONE
}

model User {
  id           String   @id @default(cuid())
  name         String
  email        String   @unique
  passwordHash String
  role         Role     @default(USER)
  createdAt    DateTime @default(now())

  appointments Appointment[]
}

model Service {
  id          String   @id @default(cuid())
  name        String
  durationMin Int
  price       Int?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  appointments Appointment[]
}

model WorkingHour {
  id        String   @id @default(cuid())
  dayOfWeek Int      // 0-6
  startMin  Int      // 0..1440 (09:00 => 540)
  endMin    Int      // 0..1440
  createdAt DateTime @default(now())
}

model Appointment {
  id        String            @id @default(cuid())
  userId    String
  serviceId String
  startAt   DateTime
  endAt     DateTime
  status    AppointmentStatus @default(PENDING)
  note      String?
  createdAt DateTime          @default(now())

  user    User    @relation(fields: [userId], references: [id])
  service Service @relation(fields: [serviceId], references: [id])

  @@index([startAt])
  @@index([userId])
  @@index([serviceId])
}
